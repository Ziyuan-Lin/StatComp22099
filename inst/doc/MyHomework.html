<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ziyuan Lin" />

<meta name="date" content="2022-12-06" />

<title>Collection of My Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Collection of My Homework</h1>
<h4 class="author">Ziyuan Lin</h4>
<h4 class="date">2022-12-06</h4>



<div id="hw0" class="section level1">
<h1>HW0</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures,
tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>We use the dataset “cars” in R.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span></code></pre></div>
<p>At the beginning, we print out the first 6 rows of the dataset in a
table.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">head</span>(cars))</span></code></pre></div>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">speed</th>
<th align="center">dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">7</td>
<td align="center">22</td>
</tr>
<tr class="odd">
<td align="center">8</td>
<td align="center">16</td>
</tr>
<tr class="even">
<td align="center">9</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
<p>Next, we use the R function <code>lm()</code> to fit a linear model
of the two coloums of “cars”.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lm.cars <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist<span class="sc">~</span>speed, <span class="at">data =</span> cars)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(lm.cars<span class="sc">$</span>coefficients)</span></code></pre></div>
<table style="width:31%;">
<colgroup>
<col width="19%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">(Intercept)</th>
<th align="center">speed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-17.58</td>
<td align="center">3.932</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.cars)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dist ~ speed, data = cars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -29.069  -9.525  -2.272   9.215  43.201 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -17.5791     6.7584  -2.601   0.0123 *  
## speed         3.9324     0.4155   9.464 1.49e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.38 on 48 degrees of freedom
## Multiple R-squared:  0.6511, Adjusted R-squared:  0.6438 
## F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
<p>The linear model fitted by least square method is <span class="math display">\[
\text{dist}=-17.58+3.932\times\text{speed},
\]</span> and the <span class="math inline">\(R^2\)</span> is 0.6438 as
is shown in the summary.</p>
<p>Finally, we plot the data points of “cars” and the results of
<code>lm()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cars)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="sc">-</span><span class="fl">17.58</span>, <span class="at">b=</span><span class="fl">3.932</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&quot;Data point and fit line&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Legend&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;fit line&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="st">&quot; &quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.cars)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAgVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OmY6OpA6kLY6kNtmAABmADpmAGZmOgBmZmZmkJBmtrZmtv+QOgCQOjqQOmaQZgCQkGaQtpCQtv+Q29uQ2/+2ZgC225C2/7a2///bkDrbtmbb/7bb///fU2v/tmb/25D//7b//9v///+y+AWxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOoklEQVR4nO1dh5bjug3VFG+Knbbypo5eVslEHvv/PzDsIlUIsErWwz1nxkUgKV2DIABSVPMgeNFsfQJ7BxEEgAgCQAQBIIIAEEEAiCAARBAAIggAEQSACAJABAEgggAQQQCIIABEEAAiCAARBIAIAkAEASCCABBBAIggAEQQACIIABEEgAgCQAQBIIIAEEEAiCAARBAAIggAEQSACAJABAEgggAQQQCIIABEEAAiCAARBIAIAkAEASCCABBBAIggAA0x5IcgqHGw9SntC8QHgJGgr8v50TfN2+eWp7M/jAR1b5+30/uje9/ydPYHQ9DXpX0MDft7/bnpCe0NDkEdI6cnghxYXez96/L2+XWhLubANtLNy8f9Svy4oGEeABEEQBLEupdBYSMtmlpsgw8TLjrYKRvahXI5UVuDuCfBrvzlY34ohqCy5HDUJkj6oYtjwd4J0t2saBdzmGGBTcM/duy1VRfLvztrgZGgQX/tlrmdWGz0X0GSkvi6fL+I2nLBCTX6d9Zk2Z9kaAxDPetnPADkSiXft+L1dtIMGYJ4xxQe2lIZQayW+Lqwb/ulHhwJy5M+PwZ2Qn3haJX/6EJJeYOi4T98PMTvwi5UfmeiHU3Q/Sq+fvlYKiP+XImcv7ITatx+81P8Fcb92ghFGa9iaIQCtIP46c0RTZD8gv1fKiPPXEsIdcppmQxB/DfgP0wFghhY1Hf7pvoBMyuvv0htGJSrsUgQO75UxiJI6GApgkSU2p0LdzGtAkxV9FvxqrrL8DISwEzuqgbZZWppkBiB2UhW1k/UoxgzM9qeCIsjbWw7ubJVG2SXmdqgcgRVwSBSlgMfkflYwwiTisC+0KPY6EYuj2JumfN0FCtFkIk2aoQakgHl0/T8c6d+/N4+g06e0XnuB+kyTGTqBxXWIEooTjDrYpSTdjEjiFTIxYwgykm7mBJEOekJZqMYTRy6oJQrgMwENU+DMIKy5aT3pI+9CkVkdDnhJJAgDuH+P4a0XNOOCLr99k8siP3dp0weiVU+1tFwgnQYmRbNFyKIZ9lEwIXX7/uPf11Hgprp2YUTpOOXNEcxN0GyY4g81bcPnqrqsV5If75fWxMAZyBIJgxQc1G+6hLKrlTH/gaRphc/IDafx1SHE8R17/c/shCkZqwS892Zx0Trv7AkD7QG9WLAEb/51x9/5rBBaihL9BOLESQV/HYK+P1EF2O0Sk7TR7EsKEWQTiVqRcJAdLFh5Tc/BkGmY1izGV2eXNhBCFIdQ/HDp+0CNMhfMf4M+H+mwXlSrmX8IGlxW5lozVPlUTSoGIggABEEZVlIfmSCsiwkPzBBeRaSH5yg6IXk4XmorRHTxXIsJC9KkMp29Km+CEeUkc6wkLwkQTrbMfrSCRp71GGekXT/oX3FaYQegqMS1L/LpENr2rJzPAEXE5nuePvszh7hjO1GQWQ7+CozoUVTgoIUKiZh9vLRcyOdxFBpDdKxKrdDE4JmCuVFXMqVJ+zT5uaLD/PKQne6j7kKVJIgPYO0X0dRZTv4y/2v4iQdo1NLg3aVtHehsh1rSY86NqhPW8a/qSddYRRLTkgdOdSo2+7WiJ84rNTu1ogbxSq2i63Pq+F1Y7EsqzcLTfvEHIVrxgmOGrS/WQ3j2iyqiv8oqmqM4J6NtKZgWVX8R1FVYwSfgKAVH9l/FFU1RnDPBCnlWKPAfxSuGScYVPP9CtipIqPYKgX+o7bQ/Fv8GWAlHzwKUr7S0Kw4TWX8oJTBbOVoEYIsX3JtJWMhRzHeHfJ1T2TT/D9uGbDlS645TXU86ZBlztb/+feotvQ7eBnwdho0byQs7zN3lmJiMXgZsMmFVLZBS22EMNTMSY2PxbwRB3jHSzJBiN4TOK6roY6/WGXio/ltM4prY058blVX8Hg85pVgSwrsYRmwx2duVj9GVRwzzIcsA16b+yhC0Pzqgv3/HBqUglyrO5AExVScbIPyoIgNGglKcxjTRrGdTD2vZn7sv/W20SFZjJHONvW88kuuRI0YYfnJ39XC3SOcoD3M55l69oSHyy4/KGw5e9sRhJh6RkRs65cRZH/dAEF/2ocG+RzF+xVSr8wENQ+HmJmlbewuHeQeRdsg/9QzuEIvL0Huy8NQ8T8Op+c18jsUlptcvaKJowg40gMwdZ/XBrmKJGEucemy8djUD0oZxRqjNrYyWpozaate0l6v/912fdBEoayPNjnOqF+PIDkybUrQ7GJH1ZlIWX+GrLLLX/gen9wAbUWQZ4ZiYmBmNrvOKMb8oPu1OW9F0GRAtzCzv0HDpK89nKBFEM+pvv2nFkGLSbCpFiwNT1sSxO/Dr0SQS8V0vOKvq4P3usNQniD2UoegyeVMr46zs17X+mRpQRuUB7EEuVenVCd46PZdzLNtLLA2oD+EVY7zbaD2mslnXEEhWeW28EmKZ0laBw3ZCZr/HuiS1TRo9htaTc8CqiB7gj6v3RCEj6xnkaYTi+U+r3iCKuxhhus1gOZsmrQvvIcZiiBAyE8fcLTG4gVEdf5DGAVal0o5uiyNEZw4igVjMUQ+qAJBVmSLQonFC6Fph2b140LliQQ1D6CRWQHLBmVavBDS/nxK2OsNe2sO6sMxw3ymPcyCbMFsUQEkHjuKaRH9f0M/KIygEOEMSCAo6XYoe3VHSQ1KR7wNync7VJINSmp8eYJkUSjGSGe7HSphFAtszRf+whYd2YZ6s9XtUAlBl0vBpGsjnHJcI9mNdGzJ8GV1bouHIShDvtRuqx5BWR7hB7e7zETMcD8tU9gG5XmEH95TQ30N1+VYacwo5jSIaWQ00jke4ZdMUJApSjTwyDbUmzyP8IslSGsDoBT5EOdJpz/CL9YGPZbn5pO8JPA0cIJGMssj/KJHMbs4diRKQcwwn+MRfokXs2+CqrbrKb/qHOfEsxKEmV3MYroDCdrto2u8dyYkVYw/A/3uaR5dk6XjxQzzu3p0jacXbUTQvh5d4+tFm2nQHu5ZdarxMbSJDYKnfWrt3QHlKqqPYgLwtE+1vTsKOkBOCxjBgLOouPNCuSDMagAnaCTB7lN1745iYbyuHy04JszA4Wsve3fkQFzCDMI+9u7Igng/yIvye3fUQrwnXandrRHtB9Vqd2vEdLGQaL7Q3h31UDkfZK/ueA48bcKsFiIIqjSzuhPEOIqImdXqG00WQ5yjCM2sbrXRZAHEOYrAzCom1HgaBBOEmFlFBKtWxbjmdyplyZsC8MwqQoNCT2SvUpb8WACeWYWD1dAT2auUJR9UAAxWQ09kr1KWvDHS6rlLWRa7ok9kr1KW/JSgtC26Qk9kr1KWvCzQjeNfjuePoE9kr1KW/FSDcmGvl17WSIdU/NRSlrwqcDudxYNMcz2u/DBQBIkYlecUE5cBHw/aSPOEtJj4SXsY9vFgtqbQaftcftBRoAlq9cwYEeTCIkian7QFVMeDZYPEypc802MHgiJoePngD1PHzND/yqD9oEGE6LcTdbAJnmcmayOo+7JjsrW/DhAfAIggAGX6FBj1ihnIM0ZULkv2St1OTfMO1tWzFlvUyTkYTRC6CAx+P4P3nob7lR3t+VVBooPIf3ulxGPWL1Bd3MsTK3zAk3Mx8pKPJjk95It6ldP++hMSFc/68FcoD0J1SQeYHYRPzsWUkRwcmcsH5NjvCIn2b38T7plH6vbtA9GsIQh7choTOrKokDxlOOplXjsgyg5zG+SVGl7/fRH2zF+X7mLYk9NwCMlkiGQPB/s5n330i/LuwAnySvV8rpMrCNCsss3IkzOwKMlmp3HnMGgbvS6qn/PhJ+hFqYS/Lh5k8rxyAkHZ1q6gtFjOXntFxUGwi0lzwkyLvy5tetK6GLIQAIwdVEuNvKK9in1ar5S8VnbdfimtOIlGOgsQI6leBgGLdtAwLxflDMAwL3mBpBZQJNIAfTExyYQT7UBHsdcUeqW0DYp3FHOiB7x51Xm4DCQqQw2v1KDDFq9Uh5KagWJVAEQQACIIABEEgAgCQAQBIIIAEEEAiCAARBAAIggAEQSACAJABAEgggAQQQCIIABEEAAiCAARBIAIAkAEASCCABBBAIggAEQQACIIwGYE6RvRW7E6Y1B/LlbWGOR5FBoS2xFk3zbDL3nhsokgDSJoDkMQu1y+VF7tmdLbi1T+LghSa5/Y+04ulmcl1D2k7cMUEHUUIG4XBI0axFdkimVOfL3TINfxqCXOb5/6tkibIF3A3NeeG/siyNxXLLWmk12MLyhkR8TmGfyARZApUOxe5K1HsdYhaNB9Sl6vskHjEb6YzCHIFPi6FGJoXxo06LG/twniSy47aZ9ef3E1yBSQ9w8d3gaZYcvRIHG3gdo1Y9LF3HGuK7DzyL4IMgO4Ws2sLvjr8mduszlpg+5iZ9WzbKUpMf7vhaCzNNCCEq4I8t4TrREdv21BKk/DJdv79e2TdarWFBjG+zDyYh8EMQbYKK79ING9Rj/oYZ75wdfvdvwOf8FU8137QVK1yuztQ8EqACIIABEEgAgCQAQBIIIAEEEAahI0d3TvV729sPRuDObp1wDwyrJtm7ktQb2+8W/iA6fFDOKWuVwbIW1K0PhFdoKMbqaiMkG303e+CwDPj7Y6ZldBhdpoTt7Eu7hltcqq3r794zTmZedvZISSa7O66gSJXU0YMWKHeL29JQ9Lv3RGY2jaRQ3SBxlPrYzOTIJ2IVObK3CtTtBZ3dIrchVnndhQIahOnGqCeBaM3zf/T/5BH5R3BDMNMfnWpUxtrj1XqxOkN2zUyRyTGpMxuiTBPPRVBPqqu+mDZpZjTNAuZGoxD5TDYEuCxGtvE6QTp8tGWh1UeycwgnS+dSlTewSC5hok0E18Igfs4EiQSRctZGqPQdDZSq4aUnTKeb0OsXcCt0FjCfnGytQewQbJUUwnV03SXmjTws+vD4qR0IxiJkE7ydQ+7ShmEzT3g3TitFvyg9TB2+kvJzXDYydoJ5naZ/SDZohzmFGdJ9sEx7bRfI/ehMUCiqCnjMXmiIqYMAQ9ZzT/lCCCAPwfNJXOq9UKiF8AAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;EnvStats&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     boxcox</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     predict, predict.lm</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     print.default</code></pre>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.3, 3.7, 3.12, and 3.13 (pages 94-96, Statistical
Computing with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>3.3</h3>
<p>The <span class="math inline">\(Pareto(a,b)\)</span> distribution has
cdf <span class="math display">\[
F(x)=1-\bigg(\frac{b}{x}\bigg)^a,\quad x\ge b&gt;0,a&gt;0.
\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform
method to simulate a random sample from the <span class="math inline">\(Pareto(2, 2)\)</span> distribution. Graph the
density histogram of the sample with <span class="math inline">\(Pareto(2, 2)\)</span> density superimposed for
comparison.</p>
<p><strong>Solution.</strong> Since <span class="math inline">\(F(x)\)</span> is continuous and strictly
increasing, we solve the equation <span class="math inline">\(y=1-(\frac{b}{x})^a\)</span> and obtain <span class="math inline">\(x=\frac{b}{(1-y)^{1/a}}\)</span>. Hence, the
inverse transformation is <span class="math display">\[
F^{-1}(U)=\frac{b}{(1-U)^{1/a}},\quad 0\le U\le1,a&gt;0,b&gt;0.
\]</span> Let <span class="math inline">\(a=b=2\)</span>, we have <span class="math inline">\(F^{-1}(U)=\frac{2}{\sqrt{1-U}}\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random sample by inverse transform method</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>U)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph for comparison, the density of Pareto(2,2) is 8/x^3</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">col =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="dv">8</span><span class="sc">/</span>d<span class="sc">^</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZjpmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa2tpC229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb/7bb////tmb/wMv/25D/27b//7b//9v///9Wf+bHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJbElEQVR4nO2deWObNhyGlTZZvKU77KU7Wndn6I6s9NhCHJvv/7mmAzC2kV5AgCX7ff5oXUwFPPz0AyFZiJw4EcfegdChIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAGML2izF1YP5+7r6R+3rP94NvcG3MyG+Vp9WM/HsXe3vfhxX0NOtx643kwnJXH9Mhdym2qh43b+8SQUdkPic22ZScXG33bZUYzT15hgR9P5GiIuv7pUfiVL08aUQz3/QwbV5K8TlnTYnj/XXW/HsPv94K9d7IY97vRDXH2/Exav8/Uyutd1MVYAuslSkKtdfXhXsKIJSIQoxpaBiiVpRnXV5hDfbxVcPmflaHrYUZLgp1Rq2BewIKpZ7VLBJBJUUglQUPOQfdKIwVUyeaONtrlPI9cMmKb1d3ef/yv/12YNaaa4FzdX/Fa+K9TX1AmpVLDdC964LHZlekDyay7+Lb42gIhMlJqjUZ3lgRlB58j/9eaMKkMvl4Zo/tbF6MXlZL2tVLxM7/+zB9ILMEpNx9CGVtVAdWvl551g3P5UFqOjLiz+3guoF7ArS25of7FQXjpCDnm5NSvm98GCOV5/t1+XnuiB1lJe/fFpYBdUL2BWU7mSkXhzlPujp55sypbaIIGNibRdkjSC54sV3nknoWDeKmzfbjGPPQfpYdWBUSbpBkDUHyVw/V/HnU8mmFySP9xtdz/SFRx2N/SpWRtDVw9PSnoNsV7FMFMncp5IdIYLeVrc1ul3gug+qcpAzSdfvg2qCVAW7M196VLJjVLEPKgO9uM+L2+b74kb4R/Mf5KIv7w+uYpe/pXKRTVCtgK2gpGhj+FWyQB93JJ63d8MRmqBEP6uQ0eHTwByS0AQV7S7f+9/hCE1Q/vRyVrT1wyA4QaFBQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAkwsSIjYzggFASgIQEGAYfa3Gk2PijtXQa2LoyD0PQWB7ykIfB+doYkFxRdCFASgIAAFASgIQEGAPru7mll/iX7egqqf9e/8qL9bcSctKM/MD9M8IyguQ932dr1Qv3PzERRdCHXd2+TijoKcpGJOQU5Ws+cU5GSztE8400pQVIamvlGMLoR67mza9z7oXATtl9L2oX1+poK6FBdZEppeUGQh1G1fy3lGrPPKnbmgtJwkJLPNFnLCgsp5rhxsltv5aCxzj7QUFJGh2q6maEK09aK6Qcz6X+YjC6HdXXU7GiiCYhZkFFlTcFq2MTrnINGCHns/ATu7peameS0DxTq5UflM0bqCVdBjDVXC4wHBC1IHbw7clmA6Fbe3/HHPUHyC1osh5jQ6ZUHfGj8e4ZOfhSBbO71jcfvL9wUdGgpbULK9mHjNDdtOUGMIhS1oG0EDFbe/PH5B4xZHQaC42AWtF/OqX3mCJN2YpYMWNHpx+zooaH/5CQiS1az3zMKwxXkKghL1woLrPPGaZfaEBamnYZlsy0/R1GjM0jEIStQs15MIagih0AXJuqVG/6wXk1SxGAXpKeA3S7+JrrsI2r838trwaBzpMt8QQhQEQih4QbDXtFtxe8sPBB2EUPCCkiFeFnfCgtSNNCQVxRutuo4PahYk4hKEX+SW6pfEqevcAIL2Qyh0QS0u8KZnVXebnaEg3c5wUwaZbLWdoaAWD8yqvvnkeiBBIiJBbSi1mNd/dSmuSdDj6QmqRi9slucoSL98MhnnlYk2QSIiQdnFXapa81N0HDYZCl2QysCp4wK+yxBJeq+ShS5IXcOVoF5PFDs/k24IodAFlRGUjPLSTYugx4gEFTkoHefV0Q5BIhZB5lbRPYqq90Bym6DHmARh+g8kdwkSJyPIYxiwVdDWUOiCTFvMmaE9BpLbBT1GIigpHoS5BpiNEkGRCMrK5Oz4RbPXQHKnIBG8oNrTMmff/DADyZtDKGhBtRbYRF3PhyEUuCCYfrsU17DcIagwREHAEAUBQxSEDHlsdkRKQdsHFhS0w9EGL8RiKBRBwRoKRlCohsISFKChgATlQSoaZof6PrTfFRSkoYAiCDPsvrYjIEGVJkeMTU9ogkwgUZBdUFHVKMgqqEpGFGQRZFVEQQeKKMgmqDGMKAgoikDQ8H3zLkG1e8dIBI3QN+8UtCsp/DvpcXpWgaC9NkiH3R2GLlscp28eCtp3NK2nCCLIammS9mzHHDRC33xrQWoNi5btKl0OpxXdShylb76LoPLTdFEU8n0QXKNVpfO0FrWgPqK6quopaKCB5AMJ6qOq7ZFO9Uw6OKYVdMJQEGDgxurpMXBj9fQYuKlh3UxAdNrxoRurHpvBqwxSSNesO1UEDbFK8IJaNFY9NnMKgnBj1WMzJyGoNxTkvxkK8l6FgqYohIIGWMVj9fODggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASYQpHsb8TNsMHnaaibQm3KryZytZXyh+2IyNNFWnfEFbZZyb1L4GuDM/aA7k9+CNzaoyZydM/auF7qzSs10k7U2NL4gM+EOmjNFTwNq/9r0ODkLMTPYOCavyUyXuSmq9QtopspB6JSlV29cglafwzOOBGVirrs7252wiqkEgRnzpQBnDsqe/bNAiQxWMdMfbFy37hqeSBDoaVRh7xSUqtqBJk2HyVdbMbHcOglNIygDORpOAZpe4NOugnQ1c52IYAWhnmod9W5BWo1zgrUWuSXUKuacWs+sYLAfvjkeZ6puERmBJumW08M6I8iMvHGednPgzlWyIC/z7rSwxX0nrbJUbfhNYwHtclBwN4pF/YF7BJoaGW6vJGiVIrzSsJoakUNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoChC1oNTMd9p7vD/YhbEHF0Ku2A0TGIHBBekwLGps4KqELUoPH/d5L6UnogmT1+t41MnF0gheERziOS/CCNsvjzrkXvKDk6j/3b1hGJnRB6rcFR52UMHBBq5n+hUr7MZeDE7agzVLnn/Wi86RpgxG0IJmgzRUe/dZjRIIWFAIUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDgf8MQQYIxZ/A+AAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="section-1" class="section level3">
<h3>3.7</h3>
<p>Write a function to generate a random sample of size <span class="math inline">\(n\)</span> from the <span class="math inline">\(Beta(a,b)\)</span> distribution by the
acceptance-rejection method. Generate a random sample of size 1000 from
the <span class="math inline">\(Beta(3,2)\)</span> distribution. Graph
the histogram of the sample with the theoretical <span class="math inline">\(Beta(3,2)\)</span> superimposed.</p>
<p><strong>Solution.</strong> Firstly, we generate a random sample from
<span class="math inline">\(Beta(3,2)\)</span> directly. The pdf of
<span class="math inline">\(Beta(3,2)\)</span> is <span class="math display">\[
f(x)=12x^2(1-x),\quad 0&lt;x&lt;1.
\]</span> The maximum point of <span class="math inline">\(f(x)\)</span>
is <span class="math inline">\(x=\frac{2}{3}\)</span> and <span class="math inline">\(f(\frac{2}{3})=\frac{16}{9}\)</span>. Hence, we
let <span class="math inline">\(g(x)=1,0&lt;x&lt;1\)</span>, and <span class="math inline">\(c=\frac{16}{9}\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g(.)</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="dv">27</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">/</span><span class="dv">4</span> <span class="sc">&gt;</span> u) {</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>j <span class="co"># The number of experiments for generating n random samples</span></span></code></pre></div>
<pre><code>## [1] 1799</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of the sample with the theoretical Beta(3,2) density superimposed</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="dv">12</span><span class="sc">*</span>d<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>d), <span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-quantile plot for ‘rbeta’ and ‘acceptance-rejection’ algorithm.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(y, z, <span class="at">xlab =</span> <span class="st">&quot;Acceptance-rejection&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;rbeta&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now we conclude the algorithm in a function. Here we use
<code>optim</code> to find the maximum of the density function <span class="math display">\[
f(x)=\frac{1}{B(a,b)}x^{a-1}(1-x)^{b-1}.
\]</span> Note that the maximum can be found if and only if <span class="math inline">\(a\ge 1,b\ge 1\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>beta_ac_rej <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, <span class="at">n=</span><span class="dv">1000</span>){</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">optim</span>(<span class="fl">0.5</span>, <span class="cf">function</span>(x) <span class="sc">-</span>x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">beta</span>(a,b), <span class="at">method =</span> <span class="st">&quot;Brent&quot;</span>, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>)<span class="sc">$</span>value</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g(.)</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">/</span>(c<span class="sc">*</span><span class="fu">beta</span>(a,b)) <span class="sc">&gt;</span> u) {</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>      <span class="co">#we accept x</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">observation=</span>y, <span class="at">iteration=</span>j)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">beta_ac_rej</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>iteration</span></code></pre></div>
<pre><code>## [1] 1799</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> result<span class="sc">$</span>observation</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="dv">12</span><span class="sc">*</span>d<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>d), <span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We get the same result as above.</p>
</div>
<div id="section-2" class="section level3">
<h3>3.12</h3>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose the rate
parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(Gamma(r,\beta)\)</span> distribution and <span class="math inline">\(Y\)</span> has <span class="math inline">\(Exp(\lambda)\)</span> distribution. That is, <span class="math inline">\((Y|\Lambda=\lambda)\sim f_Y(y|\lambda)=\lambda
e^{-\lambda y}\)</span>. Generate 1000 random observations from this
mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">rate =</span> <span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda)</span></code></pre></div>
</div>
<div id="section-3" class="section level3">
<h3>3.13</h3>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto
distribution with cdf <span class="math display">\[
F(y)=1-\bigg(\frac{\beta}{\beta+y}\bigg)^r,\quad y\ge 0.
\]</span> Generating 1000 random observations from the mixture with
<span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and
theoretical (Pareto) distributions by graphing the density histogram of
the sample and superimposing the Pareto density curve.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="at">y=</span><span class="dv">64</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>d)<span class="sc">^</span><span class="dv">5</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Fast sort algorithm</p></li>
<li><p>Exercises 5.6 (Page 150, Statistical Computing with R).</p></li>
<li><p>Exercises 5.7 (Page 150, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="fast-sort-algorithm" class="section level3">
<h3>Fast sort algorithm</h3>
<ul>
<li>For <span class="math inline">\(n=10^4, 2\times 10^4, 4\times 10^4,
6\times 10^4, 8\times 10^4\)</span>, apply the fast sorting algorithm to
randomly permuted numbers of <span class="math inline">\(1,\dots,n\)</span>.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</li>
</ul>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This part is copied from bb</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>quick_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">&lt;-</span> y[y<span class="sc">&lt;</span>a]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">&lt;-</span> y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}<span class="co">#form a loop</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## user.self 
##         0</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">quick_sort</span>(test)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># show the result of fast sort algorithm</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>test[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>test[<span class="dv">9991</span><span class="sc">:</span><span class="dv">10000</span>]</span></code></pre></div>
<pre><code>##  [1]  9991  9992  9993  9994  9995  9996  9997  9998  9999 10000</code></pre>
<p>As is shown above, the fast sort algorithm is applied on the sequence
<code>test</code> successfully.</p>
<p>Then we write a function to calculate the computation time denoted by
<span class="math inline">\(a_n\)</span>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">2e4</span>, <span class="fl">4e4</span>, <span class="fl">6e4</span>, <span class="fl">8e4</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>computation_time <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    t[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  t_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(t)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(t_mean)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">computation_time</span>(n[<span class="dv">1</span>]),<span class="fu">computation_time</span>(n[<span class="dv">2</span>]),<span class="fu">computation_time</span>(n[<span class="dv">3</span>]),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">computation_time</span>(n[<span class="dv">4</span>]),<span class="fu">computation_time</span>(n[<span class="dv">5</span>]))</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>an</span></code></pre></div>
<pre><code>## [1] 0.0104 0.0237 0.0468 0.0764 0.1045</code></pre>
<p>Now we fit a linear model with control variable <span class="math inline">\(t_n\)</span> and response <span class="math inline">\(a_n\)</span>, and draw a scatter plot and the red
regression line.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(an<span class="sc">~</span>tn)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1e6</span>,<span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(mylm)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tn, an, <span class="at">main=</span><span class="st">&quot;Regression line&quot;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-5.6" class="section level3">
<h3>Exercise 5.6</h3>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[
\theta=\int_0^1 e^x dx.
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\sim {\rm Uniform}(0,1)\)</span>. What is the
percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
<p><strong>Solution.</strong> Since <span class="math inline">\(U\sim{\rm Uniform}(0,1)\)</span>, we have <span class="math inline">\(E(e^U)=e-1=E(e^{U-1})\)</span>, and <span class="math inline">\(E(e^{2U})=(e^2-1)/2\)</span>. Hence, we have <span class="math display">\[
\begin{aligned}
Cov\left(e^U,e^{1-U}\right)&amp;=E\left(e^Ue^{1-U}\right)-E\left(e^U\right)E\left(e^{1-U}\right)
\\
&amp;=e-(e-1)^2 \\
&amp;= -0.2342106,
\end{aligned}
\]</span> and <span class="math display">\[
\begin{aligned}
Var\left(e^U+e^{1-U}\right)&amp;=E\left(e^U+e^{1-U}\right)^2-\left[E\left(e^U+e^{1-U}\right)\right]^2
\\
&amp;=E\left(e^{2U}+e^{2-2U}+2e\right)-4(e-1)^2 \\
&amp;=e^2-1+2e-4(e-1)^2 \\
&amp;=-3e^2+10e-5 \\
&amp;=0.01564999.
\end{aligned}
\]</span></p>
<p>The simple MC estimator of <span class="math inline">\(\theta\)</span> is <span class="math inline">\(\hat\theta_1=\frac{1}{m}\sum_{i=1}^m
e^{u_i}\)</span>, where <span class="math inline">\(u_i,i=1,\dots,m\)</span> is an i.i.d sample of
<span class="math inline">\({\rm Uniform(0,1)}\)</span>. The antithetic
variates estimator is <span class="math inline">\(\hat\theta_2=\frac{1}{m}\sum_{i=1}^m
\left(\frac{e^{u_i}+e^{1-u_i}}{2}\right)\)</span>. By the i.i.d
condition, we derive that <span class="math inline">\(Var(\hat\theta_1)=Var(e^U)/m\)</span>, where <span class="math display">\[
\begin{aligned}
Var(e^U)&amp;=E\left(e^{2U}\right)-\left[E(e^U)\right]^2 \\
&amp;=(e^2-1)/2-(e-1)^2 \\
&amp;=0.2420356,
\end{aligned}
\]</span> and <span class="math inline">\(Var(\hat\theta_2)=Var(e^U+e^{1-U})/4m\)</span>.
Now we can compute the percent reduction <span class="math display">\[
\begin{aligned}
100\left(\frac{Var(\hat\theta_1)-Var(\hat\theta_2)}{Var(\hat\theta_1)}\right)&amp;=100\left(\frac{0.2420356-0.01564999/4}{0.2420356}\right)
\\
&amp;=98.38.
\end{aligned}
\]</span></p>
</div>
<div id="exercise-5.7" class="section level3">
<h3>Exercise 5.7</h3>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
<p><strong>Solution.</strong> In this simulation, we generate an i.i.d
sample of <span class="math inline">\({\rm Uniform}(0,1)\)</span> with
size <span class="math inline">\(10^4\)</span>. Then we compute the
simple MC estimator <span class="math inline">\(\hat\theta_1\)</span>
and antithetic variables approach estimator <span class="math inline">\(\hat\theta_2\)</span>. Next, we compute the sample
variance and plug in to obtain the empirical estimator of percent
reduction in variance.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(U))                <span class="co"># simple MC estimator</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span>)   <span class="co"># antithetic variables estimator</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(U))                   <span class="co"># sample variance of simple MC</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span>)      <span class="co"># sample variance of antithetic variables</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>theta1</span></code></pre></div>
<pre><code>## [1] 1.719891</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>theta2</span></code></pre></div>
<pre><code>## [1] 1.71941</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(var1<span class="sc">-</span>var2)<span class="sc">/</span>var1      <span class="co"># empirical estimator of percent reduction of variance</span></span></code></pre></div>
<pre><code>## [1] 98.38075</code></pre>
<p>As is shown above, we obtain <span class="math inline">\(\hat\theta_1=1.719891\)</span> and <span class="math inline">\(\hat\theta_2=1.71941\)</span>, both are closed to
the theoretical value <span class="math inline">\(e-1=1.71828\)</span>.
The empirical estimate of percent reduction is <span class="math inline">\(98.38075\)</span>, which is also closed to the
theoretical value <span class="math inline">\(98.3835\)</span> obtained
in exercise 5.6.</p>
</div>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 5.13 (Page 150, Statistical Computing with R).</p></li>
<li><p>Exercises 5.15 (Page 150, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="exercise-5.13" class="section level3">
<h3>Exercise 5.13</h3>
<p>Find two functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad x&gt;1.
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\int_1^\infty \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\,dx
\]</span> by importance sampling? Explain.</p>
<p><strong>Solution.</strong> Firstly, let <span class="math inline">\(f_1\)</span> be the standard normal density, that
is <span class="math display">\[
f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2/2}.
\]</span> We apply the important sampling method by <span class="math inline">\(f_1\)</span> as below.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>theta.hat1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x))</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(theta.hat1, var1)</span></code></pre></div>
<pre><code>##      theta.hat1     var1
## [1,]  0.4026291 1.240724</code></pre>
<p>As is shown above, the variance is very large, which implies that the
standard normal density is not a good importance function.</p>
<p>Next, we choose gamma distribution as importance function, that is
<span class="math display">\[
f_2(x)=\frac{\lambda^r}{\Gamma(r)}x^{r-1}e^{-\lambda x},\quad x&gt;0,
\]</span> where we set <span class="math inline">\(\lambda=1\)</span>
and <span class="math inline">\(r=3\)</span> (we cannot guarantee that
this is the optimal setting, but it seems much better to cover <span class="math inline">\(x^2\)</span> than <span class="math inline">\(e^{-x^2/2}\)</span>, which would be shown in the
figures below).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="at">shape =</span> <span class="dv">3</span>,<span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dgamma</span>(x, <span class="at">shape =</span> <span class="dv">3</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>theta.hat2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(y)<span class="sc">/</span><span class="fu">f2</span>(y))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(y)<span class="sc">/</span><span class="fu">f2</span>(y))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(theta.hat2, var2)</span></code></pre></div>
<pre><code>##      theta.hat2      var2
## [1,]  0.3992933 0.2065241</code></pre>
<p>We see that <span class="math inline">\(f_2\)</span> produces much
smaller variance than <span class="math inline">\(f_1\)</span>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.05</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x}<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">#figure (a)</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d, <span class="fu">g</span>(d), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="fu">f1</span>(d), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="fu">f2</span>(d), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">#figure (b)</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d, <span class="fu">g</span>(d)<span class="sc">/</span><span class="fu">f1</span>(d), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;(B)&quot;</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="fu">g</span>(d)<span class="sc">/</span><span class="fu">f2</span>(d), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAjVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6OpA6ZpA6ZrY6kNth0E9mAABmAGZmOpBmZjpmZrZmkLZmtttmtv+QOgCQZpCQkGaQ2/+2ZgC2Zjq22/+2///bkDrbkJDbtmbbtpDb25Db2//b/9vb///fU2v/tmb/25D/27b//7b//9v///9oi5LEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHuElEQVR4nO2d63raRhRFRWqctGmBpBfTRqmV3mwpwPs/XiWNBilYw9Zozlyw9vphcJyPs7/FaKS5CLITuUoWO0DqUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQBxQYfd6lPzWGbZm8fmSXWvHiPR5ikyxerHP20DiQsqsrun5jGv8zw0T477bCNdxDaPFtS+aXaBpAXp6oddnWbdR4yFytMLUr9ZBJIWVGb6CFv9fD7GVFOKgspT9FHWloGkBekoeXb3z/25MW2Eq9jm0an+biNZBRIWVLfo9rhqMtTPdXcU7Rjr8vSHWJvEJpCwoFpMK6ht2UV3uOVZtPNYl+csaPWbbSBhQVV3WLXvkf5Fi4pAF+HbTtoqkB9B9cOgRacgSDWZr7uuS4otqH/HHk4pCeqiRBdUd42a9SklQV/3sQWpTlFdbrSimmAJddLqoI/YSavTatGNMronKZ3m26YT8TTfXsZ3DefUNqX2141wFbs8A0E/1INVu8GYr6HGgOo+Whc0mscukIfB6uU4p4w8WH0x7rIK5GG6Y33xL3nk6Y7LPHaBPEyYXZwhok+YXZaPPGH22qAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgNsWpHdJeFw3uWlBhV7gKv0tvd2yoON+o58W3hZvb1nQYXdeVS69HWS3LIgtCFHojQm30wdlRmTrdLQ3POi9on7ySAsKVGcq7nluuwUFyBMquOc6he1ZLLAg/L6EbUGCeV5JC7KGggBLElRmM3byL0RQnmWb6v3TcNAhneemBeX1BWLeth7rocYiBLXtpnrbCLIerC5E0Kb+efz3xBZk4Hx5qFTZsAxBp0Lfg2593/lCBM3Hq6Dq3v6DAhYhSM++zFlHWIQgPXHHFmTksGtOpxR0hebClYKuUdSjHwq6RnX/nVmQcWozmSlX2zwzgo/dBuqjjgOcUXTGtyB/k+SBWPikPYaHGCDiwuEmRJ2puOexCw53dH0au5Hfvo4Y7nmsgk/a0TXef8c7xBzz2ASfth+nHF2DiSfIMY/ddMeUHV15/ae/1GeYDaLFE+SYR7wFNUdf9et/vz8dPgwdRhPkmseyD4I7usruw7nqQB+HDmMJcs5jOx+kzmJX20/7H385NSuec+uI4Z5H+jpI5TlVP6UhyD2PcHDdi5ebNAS55/ET/Lh/OFXvHr/03WLcoYZDHg97FOuTaXsV8HnYk0ecMHPL8zoHq5wwc4aCABQEoCAABQEoCLCISXu1r6ycsdck7oXiqCZvgtqJF24DHqUR1KnhJs4xGkHdRgpuAx6DLQigpu/WJ24DNlM7agbr9vf0LkXQbCgIsDRBqdyzWmTdV4okvj8o1oRZc2vEYdd+1YlBkPHmv0UcYmpl9bhvvnbSIOiDqWEtQpAe8eR3TyZBH42fEWFRJwR+1+bztUnQ+0ULOh9Yh51pgiGooCA319iexdRBdtynIMgcAxPrOuib1UuPdTqO+9H9dROIJeizaVTkqQ+acTOmghvJAYuYk3ZhaWMxaygIEGsjuVAd/0TcSC5QJwARN5K71wlBxI3k7nVCsPAWFG3CbP5Hg0bcozjO5Fewqgc3kgvVEWO7NfyB10GgLAWBshQEylLQsOxIT0RBw7IUZESpoSAjPM0DKAiVfTb9YfIrCCVJpc5lWQoCZRMRlOykvRb0oi9iC+rKUtB1eBYzVNNQEICC5paloIuyl02Jgi7KUhAoS0GWZReyNg/zBD6LpbY2j/OEFZTayuqEPGEFTVibd1/JFM7Tj+a338iK1YI6Ec/Pz62seXUk8wQVNGFtXjvpDM2sI5gn8HzQhK/tVI8vmpCfsxjOk8iEWf9y+vUaQ8OuZ+Eziv3LDQUNDaUxmu/7Id+CzDfUXfyaPSs8CzLlMQjabmPNSV+ezrUf34JMecavg7bBBeGXW8hYbP7LLUQQHBwGFhQgj/BgNaygEHnEhxoBx2JB8ggPVrvXG/wc/oMwQfJIT3eEFBQkj/BgNaigIHmEB6thBYXII508rCAMBQEoCEBBAAoCJCfo1UFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAwoKqdy9XF/qPng+Pex5ZQYfdyPJL9Xb8E5QDIJBHVFA5ughs/WFMYkjkkRRUZpux4kWco0soj3AfNBYo/z4zfeu7d9zz+Bd02DWrVvlGttBE3PMEaEHX/+AX9zyhBHVfUhQa9zzBBMU517vn8S9IvVfpHGKWeUKcxZrTajqdtGWeEIdYnmVzPzjcFfc8HKwCKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQCvgspVtP2to8zJQ0EACgJ4E1Rk2eqPhATNzeNLUP7m8VRm6QianceTILXPLU9G0Pw8ngSpnV3p9EHz83gSVCQmaH4etiCA1z6oSEbQ/Dy+zmJNlpTOYrPz8DoIwMEqgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwPKTj1n09yUIAAAAAASUVORK5CYII=" /><!-- --></p>
<p>As is shown in the figure (B), <span class="math inline">\(g(x)/f_1(x)\)</span> tends to infinity, while
<span class="math inline">\(g(x)/f_2(x)\)</span> tends to zero. That’s
why <span class="math inline">\(f_2\)</span> performs much better than
<span class="math inline">\(f_1\)</span> in the importance sampling
procedure.</p>
</div>
<div id="exercise-5.15" class="section level3">
<h3>Exercise 5.15</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10</p>
<p><strong>Solution.</strong> In Example 5.10 our best result was
obtained with importance function <span class="math inline">\(f(x)=e^{-x}/(1-e^{-1}),0&lt;x&lt;1\)</span>. Now
divide the interval to five subintervals, such that each interval has
probability <span class="math inline">\(1/5\)</span> under the density
function <span class="math inline">\(f\)</span>.</p>
<p>Denote the partition points by <span class="math inline">\(a_i,i=0,1,\dots,5\)</span>, where <span class="math inline">\(a_0=0\)</span> and <span class="math inline">\(a_5=1\)</span>. Since <span class="math display">\[
\int_{a_i}^{a_{i+1}}\frac{e^{-x}}{1-e^{-1}}=\frac{1}{5},\quad
i=0,1,2,3,4,
\]</span> we have <span class="math display">\[
a_{i+1}=-\log\left(e^{-a_i}-\frac15+\frac15 e^{-1}\right),\quad
i=0,1,2,3.
\]</span> Hence we may compute the partition points with R code.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fl">0.8</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[i<span class="dv">-1</span>])<span class="sc">-</span><span class="fl">0.2</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] 0.1351603 0.2914869 0.4768628 0.7046055 1.0000000</code></pre>
<p>Next, we generate <span class="math inline">\(m=2000\)</span>
replicates in each subinterval by inverse transform method. Denote the
p.d.f. and c.d.f. on interval <span class="math inline">\([a_{i-1},a_i)\)</span> by <span class="math inline">\(f_i\)</span> and <span class="math inline">\(F_i\)</span>, <span class="math inline">\(i=1,\dots,5\)</span>. We can derive that <span class="math display">\[
f_i(x)=\frac{5e^{-x}}{1-e^{-1}},\quad a_{i-1}\le x&lt; a_i,
\]</span> and <span class="math display">\[
F_i(x)=\frac{5}{1-e^{-1}}\left(e^{-a_{i-1}}-e^{-x}\right){\rm
I}(a_{i-1}\le x&lt; a_i)+{\rm I}(x\ge a_i).
\]</span> Then <span class="math display">\[
F_i^{-1}(U)=-\log\left(e^{-a_{i-1}}-\frac{1-e^{-1}}{5}U\right),\quad
0&lt;U&lt;1.
\]</span> Here we omit the values <span class="math inline">\(\{0,1\}\)</span> since <span class="math inline">\(P(U\in\{0,1\})=0\)</span>.</p>
<p>Now we run R code to obtain the stratified importance sampling
estimate.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(M)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># density function on each subinterval</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse of distribution functions</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>F1_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>F2_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[<span class="dv">1</span>])<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>F3_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[<span class="dv">2</span>])<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>F4_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[<span class="dv">3</span>])<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>F5_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[<span class="dv">4</span>])<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="co"># samples generated by inverse transform method</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2000</span>, <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">F1_inv</span>(U[<span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>])</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">F2_inv</span>(U[<span class="dv">2001</span><span class="sc">:</span><span class="dv">4000</span>])</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">F3_inv</span>(U[<span class="dv">4001</span><span class="sc">:</span><span class="dv">6000</span>])</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">F4_inv</span>(U[<span class="dv">6001</span><span class="sc">:</span><span class="dv">8000</span>])</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">F5_inv</span>(U[<span class="dv">8001</span><span class="sc">:</span><span class="dv">10000</span>])</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="co"># estimator of mean and variance on each subinterval</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>sigma2.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>  theta.hat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(x[,i])<span class="sc">/</span><span class="fu">f</span>(x[,i]))</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  sigma2.hat[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(x[,i])<span class="sc">/</span><span class="fu">f</span>(x[,i]))</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="co"># show the result</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">sum</span>(theta.hat)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(sigma2.hat)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma2)</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(theta, sigma2,se)</span></code></pre></div>
<pre><code>##          theta       sigma2          se
## [1,] 0.5246857 8.804783e-05 0.009383381</code></pre>
<p>As is shown above, we obtain the estimator <span class="math inline">\(\hat{\theta}^{SI}=0.525\)</span> with variance
<span class="math inline">\(8.8\times 10^{-5}\)</span> and standard
error <span class="math inline">\(0.00938\)</span>. The best result
obtained in Example 5.10 is <span class="math inline">\(\hat\theta=0.525\)</span> with standard error
<span class="math inline">\(0.0966\)</span>. It is clear that the
standard error of the stratified importance sampling method is much
smaller than the importance sampling method, which shows the power of
the stratified sampling procedure.</p>
</div>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 6.4 (Page 180, Statistical Computing with R).</p></li>
<li><p>Exercises 6.8 (Page 181, Statistical Computing with R).</p></li>
<li><p>Discussion</p></li>
</ol>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="exercise-6.4" class="section level3">
<h3>Exercise 6.4</h3>
<p>Suppose that <span class="math inline">\(X_1,\dots, X_n\)</span> are
a random sample from a from a log normal distribution with unknown
parameters. Construct a <span class="math inline">\(95\%\)</span>
confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
<p><strong>Solution.</strong></p>
<p>The log normal distribution has density <span class="math display">\[
f(x)=\frac{1}{\sqrt{2\pi}\sigma x}e^{-(\log(x)-\mu)^2/2\sigma^2},
\]</span> where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the mean and standard
deviation of the logarithm. Moreover, if <span class="math inline">\(X\sim LN(\mu,\sigma^2)\)</span>, then <span class="math inline">\(\ln X\sim N(\mu,\sigma^2)\)</span>. Hence, the
confidence interval of level <span class="math inline">\(\alpha\)</span>
can be formulated by <span class="math display">\[
[\bar{Y}-t_{n-1}(\alpha/2)S_y/\sqrt{n},\bar{Y}+t_{n-1}(\alpha/2)S_y/\sqrt{n}]
\]</span></p>
<p>We first write functions to generate a sample and construct the
confidence interval based the sample and given confidence level.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample generation function</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>sample_gen <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="dv">1</span>){</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="at">n=</span>n, <span class="at">meanlog =</span> mu, <span class="at">sdlog =</span> sigma)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data analysis function (constuct a confidence interval with level alpha)</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">alpha=</span><span class="fl">0.05</span>){</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">log</span>(x)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  mu.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  sigma2.hat <span class="ot">&lt;-</span> <span class="fu">var</span>(y)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> mu.hat<span class="sc">+</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(sigma2.hat<span class="sc">/</span>n)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> mu.hat<span class="sc">+</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(sigma2.hat<span class="sc">/</span>n)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">&quot;lower.bound&quot;</span><span class="ot">=</span>lower,<span class="st">&quot;upper.bound&quot;</span><span class="ot">=</span>upper))</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we apply our function under the setting <span class="math inline">\(n=10,\mu=0,\sigma^2=1\)</span>, and repeat for
<span class="math inline">\(m=10000\)</span> times to estimate the
coverage probability (CP).</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> upper <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  Sample <span class="ot">&lt;-</span> <span class="fu">sample_gen</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="dv">1</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  lower[i] <span class="ot">&lt;-</span> <span class="fu">CI</span>(<span class="at">x=</span>Sample)[<span class="dv">1</span>]</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  upper[i] <span class="ot">&lt;-</span> <span class="fu">CI</span>(<span class="at">x=</span>Sample)[<span class="dv">2</span>]</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>CP <span class="ot">&lt;-</span> <span class="fu">mean</span>((lower<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">&amp;</span>(upper<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;CP =&quot;</span>,CP)</span></code></pre></div>
<pre><code>## CP = 0.9505</code></pre>
<p>Finally, we clean the memory of the variables.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercise-6.8" class="section level3">
<h3>Exercise 6.8</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F
test of equal variance, at significance level <span class="math inline">\(\hat\alpha \doteq 0.055\)</span>. Compare the
power of the Count Five test and F test for small, medium, and large
sample sizes. (Recall that the F test is not applicable for non-normal
distributions.)</p>
<p><strong>Solution.</strong> At the beginning, we write the functions
of “Count Five” test and F test.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The functions of &quot;Count Five&quot; test is copied from the book</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>maxout <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>F.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">alpha=</span><span class="fl">0.05</span>){</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  S1 <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  S2 <span class="ot">&lt;-</span> <span class="fu">var</span>(y)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> S2<span class="sc">/</span>S1</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(f<span class="sc">&gt;</span><span class="fu">qf</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df1 =</span> n<span class="dv">-1</span>,<span class="at">df2 =</span> m<span class="dv">-1</span>)<span class="sc">||</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>                           f<span class="sc">&lt;</span><span class="fu">qf</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df1 =</span> n<span class="dv">-1</span>,<span class="at">df2 =</span> m<span class="dv">-1</span>)))</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we write functions to compute the empirical power of “Count
Five” test and F test.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>power_count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n1, n2, sigma1, sigma2){</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count5test</span>(x, y)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>power_F.test <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n1, n2, sigma1, sigma2){</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">F.test</span>(x, y, <span class="at">alpha =</span> <span class="fl">0.055</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we compute the powers of the two tests under different sample
sizes, that is <span class="math inline">\(n_1=n_2=20,100,1000\)</span>,
and we summarize the results in the table below.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  result1[i] <span class="ot">&lt;-</span> <span class="fu">power_count5test</span>(m, <span class="at">n1=</span>n[i], <span class="at">n2=</span>n[i], sigma1, sigma2)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  result2[i] <span class="ot">&lt;-</span> <span class="fu">power_F.test</span>(m, <span class="at">n1=</span>n[i], <span class="at">n2=</span>n[i], sigma1, sigma2)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;size&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">200</span>),<span class="st">&quot;count five test&quot;</span><span class="ot">=</span>result1,</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;F test&quot;</span><span class="ot">=</span>result2))</span></code></pre></div>
<table style="width:47%;">
<colgroup>
<col width="9%" />
<col width="25%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">size</th>
<th align="center">count.five.test</th>
<th align="center">F.test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">20</td>
<td align="center">0.3104</td>
<td align="center">0.4162</td>
</tr>
<tr class="even">
<td align="center">100</td>
<td align="center">0.8545</td>
<td align="center">0.9807</td>
</tr>
<tr class="odd">
<td align="center">200</td>
<td align="center">0.998</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>From the table we can see that the power of F test is higher than the
power of “Count Five” test when the sample is normal distributed.</p>
<p>Finally, we clean the memory of the variables.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<ul>
<li>If we obtain the powers for two methods under a particular
simulation setting with <span class="math inline">\(10,000\)</span>
experiments: say, <span class="math inline">\(0.651\)</span> for one
method and <span class="math inline">\(0.676\)</span> for another
method. Can we say the powers are different at <span class="math inline">\(0.05\)</span> level?</li>
<li>What is the corresponding hypothesis test problem?</li>
<li>Which test can we use? Z-test, two-sample t-test, paired t-test or
McNemar test? Why?</li>
<li>Please provide the least necessary information for hypothesis
testing.</li>
</ul>
<p><strong>Solution.</strong> Denote the power of the two test by <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>, then the corresponding hypothesis
test problem is <span class="math display">\[
H_0:p_2-p_1=0\leftrightarrow H_1:p_2-p_1\neq 0.
\]</span> Now from the simulation we obtain that <span class="math inline">\(\hat p_1=0.651\)</span> and <span class="math inline">\(\hat p_2=0.676\)</span>, where the number of
trials is <span class="math inline">\(n=10000\)</span>.</p>
<p>Naturally we may assume that the <span class="math inline">\(10000\)</span> experiments are independent.
However, in each experiment, the results of the two tests are based on
the same data and parameters, thus they are not independent with each
other. Namely, we have obtained <span class="math inline">\(10000\)</span> paired data in the simulation.</p>
<p>Consequently, we cannot use two-sample t-test and Z-test (the large
sample version of two-sample t-test), because the two samples
corresponding to the two tests are not independent. Unfortunately, if we
want to apply paired t-test or McNemar test (an equivalent of paired
t-test for binary response data), the result of each experiment, namely,
whether the two tests reject or accept <span class="math inline">\(H_0\)</span>, is required.</p>
<p>In conclusion, we can use paired t-test or McNemar test provided the
result of each experiment. That means we cannot say the powers are
different at <span class="math inline">\(0.05\)</span> level if we only
know that <span class="math inline">\(\hat p_1=0.651\)</span> and <span class="math inline">\(\hat p_2=0.676\)</span> with size <span class="math inline">\(n=10000\)</span>. Note that it is more complicated
than testing the equivalence of type-I error, since the <strong>real
distribution of the data is unknown</strong> under the alternative
hypothesis!</p>
</div>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercise 7.4 (Page 212, Statistical Computing with R).</p></li>
<li><p>Exercise 7.5 (Page 212, Statistical Computing with R).</p></li>
<li><p>Project 7.A (Page 213, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="exercise-7.4" class="section level3">
<h3>Exercise 7.4</h3>
<p>Refer to the air-conditioning data set <code>aircondit</code>
provided in the <code>boot</code> package. The <span class="math inline">\(12\)</span> observations are the times in hours
between failures of airconditioning equipment [63, Example 1.1]: <span class="math display">\[
3, 5, 7, 18, 43, 85, 91, 98,100, 130, 230, 487.
\]</span> Assume that the times between failures follow an exponential
model <span class="math inline">\({\rm Exp}(\lambda)\)</span>. Obtain
the MLE of the hazard rate <span class="math inline">\(\lambda\)</span>
and use bootstrap to estimate the bias and standard error of the
estimate.</p>
<p><strong>Solution.</strong> Suppose <span class="math inline">\(X\sim{\rm Exp}(\lambda)\)</span>, then the hazard
rate of <span class="math inline">\(X\)</span> is <span class="math display">\[
R(x)=-\ln(1-F(x))=\lambda.
\]</span> The MLE of <span class="math inline">\(\lambda\)</span> is
<span class="math inline">\(1/\bar{X}\)</span>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(aircondit<span class="sc">$</span>hours) <span class="co"># MLE of lambda</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap estimates</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>lambdastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(aircondit<span class="sc">$</span>hours,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>lambdastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="at">MLE=</span>lambda,<span class="at">bias=</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">se.boot=</span><span class="fu">sd</span>(lambdastar)),<span class="dv">4</span>))</span></code></pre></div>
<table style="width:39%;">
<colgroup>
<col width="12%" />
<col width="12%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">MLE</th>
<th align="center">bias</th>
<th align="center">se.boot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.0093</td>
<td align="center">0.0013</td>
<td align="center">0.0043</td>
</tr>
</tbody>
</table>
<p>As is shown above, the MLE of the hazard rate is 0.0093, and the
bootstrap estimators of bias and standard error is 0.0013 and
0.0043.</p>
</div>
<div id="exercise-7.5" class="section level3">
<h3>Exercise 7.5</h3>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95\%\)</span> bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p><strong>Solution.</strong> The MLE of <span class="math inline">\(1/\lambda\)</span> is <span class="math inline">\(\bar{X}\)</span>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>aircondit<span class="sc">$</span>hours,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>ci</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 999 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = de, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.2, 180.7 )   ( 26.4, 168.3 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.8, 189.8 )   ( 56.0, 228.5 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE=&quot;</span>,ci<span class="sc">$</span>t0)</span></code></pre></div>
<pre><code>## MLE= 108.0833</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(de<span class="sc">$</span>t)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>de<span class="sc">$</span>t0,<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lower alpha/2 quantile</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">sort</span>(de<span class="sc">$</span>t)[<span class="dv">25</span>],<span class="at">col=</span><span class="st">&#39;green&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># upper alpha/2 quantile</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">sort</span>(de<span class="sc">$</span>t)[<span class="dv">975</span>],<span class="at">col=</span><span class="st">&#39;green&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the length of the confidence intervals</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>interval.length <span class="ot">&lt;-</span> <span class="fu">c</span>(ci<span class="sc">$</span>normal[<span class="dv">3</span>]<span class="sc">-</span>ci<span class="sc">$</span>normal[<span class="dv">2</span>],ci<span class="sc">$</span>basic[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span>],</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                  ci<span class="sc">$</span>percent[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span>],ci<span class="sc">$</span>bca[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span>])</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(interval.length) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>,<span class="st">&quot;BCa&quot;</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(interval.length)</span></code></pre></div>
<table style="width:53%;">
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="18%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">normal</th>
<th align="center">basic</th>
<th align="center">percentile</th>
<th align="center">BCa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">147.4</td>
<td align="center">141.9</td>
<td align="center">141.9</td>
<td align="center">172.5</td>
</tr>
</tbody>
</table>
<p>From the histogram we can see that the mean of <span class="math inline">\(\{\hat{\theta^*}\}\)</span> is smaller than the
median, which causes the difference between the basic interval and the
percentile interval. The length of these two intervals is equal, but
both of the lower bound and upper bound of the basic interval are
smaller.</p>
<p>What’s more, we observe that the length of the BCa interval is
significantly larger than the others, and the center of BCa interval is
much larger than the mean. It is possibly because the bias correction
<span class="math inline">\(\hat{z}_0\)</span> and the skewness <span class="math inline">\(\hat{a}\)</span> are non-zero.</p>
</div>
<div id="project-7.a" class="section level3">
<h3>Project 7.A</h3>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal population and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the proportion of times that the confidence
intervals miss on the right.</p>
<p><strong>Solution.</strong> For simplicity, we assume that the sample
comes from <span class="math inline">\(N(0,1)\)</span>. We say the
confidence interval <span class="math inline">\([\hat\theta_1,\hat\theta_2]\)</span> miss on the
left (right) if <span class="math inline">\(\hat\theta_2&lt;\theta\)</span> (<span class="math inline">\(\hat\theta_1&gt;\theta\)</span>), where <span class="math inline">\(\theta\)</span> is the real parameter of
interest.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">2e1</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e2</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.perc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set the real parameter</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,mu,sigma)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>R,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Coverage probability</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>CP <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu))</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="co"># the proportion of times that the confidence intervals miss on the left</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>miss.left <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>] <span class="sc">&lt;</span> mu),</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>] <span class="sc">&lt;</span> mu),</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>] <span class="sc">&lt;</span> mu))</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="co"># the proportion of times that the confidence intervals miss on the right</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>miss.right <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>] <span class="sc">&gt;</span> mu),</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>] <span class="sc">&gt;</span> mu),</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>] <span class="sc">&gt;</span> mu))</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(CP,miss.left,miss.right,</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>)))</span></code></pre></div>
<table style="width:68%;">
<colgroup>
<col width="23%" />
<col width="9%" />
<col width="16%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">CP</th>
<th align="center">miss.left</th>
<th align="center">miss.right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>normal</strong></td>
<td align="center">0.94</td>
<td align="center">0.04</td>
<td align="center">0.02</td>
</tr>
<tr class="even">
<td align="center"><strong>basic</strong></td>
<td align="center">0.94</td>
<td align="center">0.04</td>
<td align="center">0.02</td>
</tr>
<tr class="odd">
<td align="center"><strong>percentile</strong></td>
<td align="center">0.93</td>
<td align="center">0.04</td>
<td align="center">0.03</td>
</tr>
</tbody>
</table>
<p>The empirical coverage probability of the three intervals are all
closed to <span class="math inline">\(95\%\)</span>.</p>
</div>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercise 7.8 (Page 213, Statistical Computing with R).</p></li>
<li><p>Exercise 7.11 (Page 213, Statistical Computing with R).</p></li>
<li><p>Exercise 8.2 (Page 242, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="exercise-7.8" class="section level3">
<h3>Exercise 7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<p><strong>Solution.</strong> Library the package
<code>bootstrap</code>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span></code></pre></div>
<p>The R functions <code>cov</code> and <code>var</code> give the
unbiased estimator <span class="math inline">\(\hat\Sigma=\frac{1}{n-1}\sum_{i=1}^n(\mathbf{x}_i-\overline{\mathbf{x}})(\mathbf{x}_i-\overline{\mathbf{x}})^\mathrm{T}\)</span>.
However, under Gaussian assumption, the MLE of <span class="math inline">\(\Sigma\)</span> is <span class="math inline">\(\hat\Sigma=\frac{1}{n}\sum_{i=1}^n(\mathbf{x}_i-\overline{\mathbf{x}})(\mathbf{x}_i-\overline{\mathbf{x}})^\mathrm{T}\)</span>.
Hence, the MLE is computed by <code>(n-1)*cov(scor)/n</code>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">cov</span>(scor)<span class="sc">/</span>n</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma)<span class="sc">$</span>values</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  lambda.jack <span class="ot">&lt;-</span> <span class="fu">eigen</span>((n<span class="dv">-2</span>)<span class="sc">*</span><span class="fu">cov</span>(scor[<span class="sc">-</span>i,])<span class="sc">/</span>(n<span class="dv">-1</span>))<span class="sc">$</span>values</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> lambda.jack[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.jack)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">var</span>(theta.jack)<span class="sc">/</span>n)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias=</span>bias,<span class="at">standard.error=</span>sd),<span class="dv">3</span>))</span></code></pre></div>
<table style="width:35%;">
<colgroup>
<col width="11%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">bias</th>
<th align="center">standard.error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.001</td>
<td align="center">0.05</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-7.11" class="section level3">
<h3>Exercise 7.11</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<p><strong>Solution.</strong> Clean the memory and library the package
<code>DAAG</code>. Note that the terminal “leave <span class="math inline">\(p\)</span> out” is different from “<span class="math inline">\(K\)</span>-fold”, see google for more details. The
code below is copied from the textbook, except for some small
modifies.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> n,<span class="at">ncol =</span> n)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  e1[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)] <span class="sc">+</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  e2[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  e3[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>  logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[<span class="fu">c</span>(i,j)])</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>  e4[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">sum</span>(e1)<span class="sc">/</span><span class="fu">choose</span>(n,<span class="dv">2</span>), <span class="fu">sum</span>(e2)<span class="sc">/</span><span class="fu">choose</span>(n,<span class="dv">2</span>), <span class="fu">sum</span>(e3)<span class="sc">/</span><span class="fu">choose</span>(n,<span class="dv">2</span>), </span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sum</span>(e4)<span class="sc">/</span><span class="fu">choose</span>(n,<span class="dv">2</span>)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 19.5723 17.8702 18.4549 20.4672</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span></code></pre></div>
<p>According to the prediction error criterion, Model 2, the quadratic
model, would be the best fit for the data.</p>
</div>
<div id="exercise-8.2" class="section level3">
<h3>Exercise 8.2</h3>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function <code>cor</code> with
<code>method = &quot;spearman&quot;</code>. Compare the achieved significance
level of the permutation test with the p-value reported by
<code>cor.test</code> on the same samples.</p>
<p><strong>Solution.</strong> Suppose that the sample <span class="math inline">\(\{(x_i,y_i)\}_{i=1}^n\)</span> comes from
bivariate normal distribution, and we set the correlation coefficient
<span class="math inline">\(\rho=0.4\)</span>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,rho,rho,<span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, Sigma)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> xy[,<span class="dv">1</span>]</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> xy[,<span class="dv">2</span>]</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>rho.hat <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the permutation test</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>rho.perm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  y.perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(y, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  rho.perm[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y.perm, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a><span class="co"># compute p-value of permutation test (two-side)</span></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(rho.perm) <span class="sc">&gt;</span> <span class="fu">abs</span>(rho.hat))</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the theoretical p-value of spearman test</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>p.tilde <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="at">permutation=</span>p.hat, <span class="at">cor.test=</span>p.tilde,<span class="at">row.names =</span> <span class="st">&quot;p.value&quot;</span>))</span></code></pre></div>
<table style="width:54%;">
<colgroup>
<col width="19%" />
<col width="19%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">permutation</th>
<th align="center">cor.test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>p.value</strong></td>
<td align="center">0.052</td>
<td align="center">0.04985</td>
</tr>
</tbody>
</table>
<p>We can see that the p-value of permutation test is closed to the
theoretical one.</p>
</div>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercise 9.4 (Page 277, Statistical Computing with R).</p></li>
<li><p>Exercise 9.7 (Page 278, Statistical Computing with R).</p></li>
</ol>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="exercise-9.4" class="section level3">
<h3>Exercise 9.4</h3>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<p><strong>Solution.</strong> The standard Laplace distribution has
density <span class="math inline">\(f(x)=\frac12
e^{-|x|},x\in\mathbb{R}\)</span>. We use the proposal distribution <span class="math inline">\(N(X_t,\sigma^2)\)</span> to generate the target
distribution.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="co"># the density of standard Laplace distribution</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma,x0,N){ <span class="co">#random walk sampler</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean =</span> x[i<span class="dv">-1</span>],<span class="at">sd =</span> sigma)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> (<span class="fu">f</span>(y)<span class="sc">*</span><span class="fu">dnorm</span>(x[i<span class="dv">-1</span>],<span class="at">mean =</span> y,<span class="at">sd =</span> sigma))<span class="sc">/</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">f</span>(x[i<span class="dv">-1</span>])<span class="sc">*</span><span class="fu">dnorm</span>(y,<span class="at">mean =</span> x[i<span class="dv">-1</span>],<span class="at">sd =</span> sigma))</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u[i] <span class="sc">&lt;=</span> alpha){</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">k=</span>k,<span class="at">accept.rate=</span><span class="dv">1</span><span class="sc">-</span>k<span class="sc">/</span>N))</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">12000</span></span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>sgm <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>accept.rate <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> k)</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> k)</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> X2 <span class="ot">&lt;-</span> X3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> k,<span class="at">ncol =</span> n)</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>  chain <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sgm[<span class="dv">1</span>],x0[i],n)</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a>  X1[i, ] <span class="ot">&lt;-</span> chain<span class="sc">$</span>x</span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a>  accept.rate[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> chain<span class="sc">$</span>accept.rate</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>  chain <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sgm[<span class="dv">2</span>],x0[i],n)</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>  X2[i, ] <span class="ot">&lt;-</span> chain<span class="sc">$</span>x</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>  accept.rate[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> chain<span class="sc">$</span>accept.rate</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>  chain <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sgm[<span class="dv">3</span>],x0[i],n)</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>  X3[i, ] <span class="ot">&lt;-</span> chain<span class="sc">$</span>x</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>  accept.rate[<span class="dv">3</span>,i] <span class="ot">&lt;-</span> chain<span class="sc">$</span>accept.rate</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a>psi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X1, <span class="dv">1</span>, cumsum))</span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi1))</span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a>psi1[i,] <span class="ot">&lt;-</span> psi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi1))</span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a>psi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X2, <span class="dv">1</span>, cumsum))</span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi2))</span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>psi2[i,] <span class="ot">&lt;-</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2))</span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a>psi3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X3, <span class="dv">1</span>, cumsum))</span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi3))</span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a>psi3[i,] <span class="ot">&lt;-</span> psi3[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi3))</span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(accept.rate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sigma.1&quot;</span>,<span class="st">&quot;sigma.2&quot;</span>,<span class="st">&quot;sigma.3&quot;</span>)</span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(accept.rate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;chain.1&quot;</span>,<span class="st">&quot;chain.2&quot;</span>,<span class="st">&quot;chain.3&quot;</span>,<span class="st">&quot;chain.4&quot;</span>)</span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(accept.rate)</span></code></pre></div>
<table style="width:75%;">
<colgroup>
<col width="19%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">chain.1</th>
<th align="center">chain.2</th>
<th align="center">chain.3</th>
<th align="center">chain.4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>sigma.1</strong></td>
<td align="center">0.703</td>
<td align="center">0.7001</td>
<td align="center">0.706</td>
<td align="center">0.701</td>
</tr>
<tr class="even">
<td align="center"><strong>sigma.2</strong></td>
<td align="center">0.5185</td>
<td align="center">0.5189</td>
<td align="center">0.5312</td>
<td align="center">0.5237</td>
</tr>
<tr class="odd">
<td align="center"><strong>sigma.3</strong></td>
<td align="center">0.4153</td>
<td align="center">0.4226</td>
<td align="center">0.4112</td>
<td align="center">0.4083</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;sigma.1&quot;</span><span class="ot">=</span><span class="fu">Gelman.Rubin</span>(psi1),</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;sigma.2&quot;</span><span class="ot">=</span><span class="fu">Gelman.Rubin</span>(psi2),</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;sigma.3&quot;</span><span class="ot">=</span><span class="fu">Gelman.Rubin</span>(psi3),<span class="at">row.names =</span> <span class="st">&quot;R.hat&quot;</span>))</span></code></pre></div>
<table style="width:58%;">
<colgroup>
<col width="16%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">sigma.1</th>
<th align="center">sigma.2</th>
<th align="center">sigma.3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>R.hat</strong></td>
<td align="center">1.072</td>
<td align="center">1.028</td>
<td align="center">1.045</td>
</tr>
</tbody>
</table>
<p>We can see that the acceptance rates is decreasing as the variance of
proposal distribution increasing. The <span class="math inline">\(\hat{R}\)</span> values suggest the chain of <span class="math inline">\(\sigma=1\)</span> should be longer.</p>
<p>We choose the first chain of different variances to compare the rate
of convergence.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>rhat1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>rhat1[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat1[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>rhat2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>rhat2[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat2[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>rhat3 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>rhat3[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi3[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat3[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The chain would converge faster if we choose a larger variance.</p>
</div>
<div id="exercise-9.7" class="section level3">
<h3>Exercise 9.7</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation <span class="math inline">\(0.9\)</span>.
Plot the generated sample after discarding a suitable burn-in sample.
Fit a simple linear regression model <span class="math inline">\(Y =
\beta_0 + \beta_1 X\)</span> to the sample and check the residuals of
the model for normality and constant variance.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#length of chain</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span><span class="sc">*</span>k) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dv">2</span>) <span class="co">#initialize</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, k<span class="sc">+</span>j]</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>    X[i, j] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i, j]</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>    X[i, k<span class="sc">+</span>j] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[, <span class="dv">1</span><span class="sc">:</span>k]</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> X[, (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>k)]</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[b<span class="sc">:</span>N,<span class="dv">1</span>],y[b<span class="sc">:</span>N,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y[b<span class="sc">:</span>N,<span class="dv">1</span>]<span class="sc">~</span>x[b<span class="sc">:</span>N,<span class="dv">1</span>])</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mylm)</span></code></pre></div>
<pre><code>##  (Intercept)    x[b:N, 1] 
## -0.002781169  0.897011540</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mylm)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABd1BMVEUAAAAAADoAAGYALoYAOjoAOpAAWrYAZrYnAAAnWaUndc4oAAArJFkrftsuNWY6AAA6ADo6AGY6OgA6Ojo6OmY6On46OpA6ZrY6kLY6kNs/AAA/AD8/cZ4/ccBGlO9MAABMACRMcZ5Mn/9ZJCdZiJ5js+9mAABmADpmAGZmOgBmOpBmZmZmkJBmqtBmtrZmtuBmtv91ztuGLieIWSSJ4P+QMgCQOgCQOjqQOmaQZgCQkGaQtv+Q27aQ29uQ2/+X0O+ckDqeiGOennGenp6enrCensCesNCewOClfjqlsNCwnp6wnrCws4aw0O+2ZgC2Zjq2tma225C2/7a2//++vr7AcT/AiFnAnp7AnrDAwZDA4ODA4P/BkDrQsJ7Q0MDQ4NDQ7//bhi7bkDrbtmbb25Db/9vb///fU2vgwJ7g79Dg/9vg///v0H7v0LDv/9vv////tmb/237/25D/4KX/4MD/4OD/79D//5///7b//9v//+D//+////9bKoOHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATIklEQVR4nO1dCYPbRhWeXbqYe8MVMFc5Ny2FYi4XAhioGwqhMW03sEAIBFE2CyFgzBLWG/14Zt7ckqU3l7SyM1+y1kgePc18fu/Nm0MSKTNaQa66AENHJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJghBJgiBJujiaFwWhBycXmFpBghN0OLgdHU4KhejKyzNAKEIujialEtC//aPr7I8g4NF0IKSU2SCLBgmNro4Oji9OMomZsF00mRvtp5mfmx00syvpwQw3vAdM2WO5d6s5dtGLPptZzsiCPSQ+fwWZIIQe90mgqj/UUjQiklmoC6FsLXVIU1MBAX04N7NvRnswMcCvoS0yAinsA0lUh8yCeKSVSZ5pYsbN1klFvKUBb+WLokXOtegghZtdSjqQY2O00ErsCQGQQuRk6ZlRiVncfCOPmQQJCTLTKfySqwx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" /><!-- --></p>
<p>From the plot of the first chain of <span class="math inline">\((x,y)\)</span>, we can see that the chain
converges to bivariate normal distribution. From the Q-Q plot we see
that the residuals are normal distributed.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>psi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">2</span>, cumsum))</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi1))</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>psi1[i,] <span class="ot">&lt;-</span> psi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi1))</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>psi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(y, <span class="dv">2</span>, cumsum))</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi2))</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>psi2[i,] <span class="ot">&lt;-</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2))</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;x&quot;</span><span class="ot">=</span><span class="fu">Gelman.Rubin</span>(psi1),</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;y&quot;</span><span class="ot">=</span><span class="fu">Gelman.Rubin</span>(psi2),</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">row.names =</span> <span class="st">&quot;R.hat&quot;</span>))</span></code></pre></div>
<table style="width:39%;">
<colgroup>
<col width="16%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">x</th>
<th align="center">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>R.hat</strong></td>
<td align="center">1.082</td>
<td align="center">1.086</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,2))</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>rhat1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>rhat1[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat1[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>rhat2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>rhat2[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat2[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We compute <span class="math inline">\(\hat{R}\)</span> value for
<span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> seperately, the result shows that both
coordinates converge.</p>
</div>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<p><strong>Solution.</strong> The test statistic is <span class="math inline">\(T=\frac{\hat\alpha\hat\beta}{\sqrt{\hat\alpha^2s_\alpha^2+\hat\beta^2s_\beta^2}}\)</span>.
The following function is used to compute <span class="math inline">\(T\)</span>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>T.stat <span class="ot">&lt;-</span> <span class="cf">function</span>(X,M,Y){</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  model.m <span class="ot">&lt;-</span> <span class="fu">lm</span>(M<span class="sc">~</span>X)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  model.y <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>M<span class="sc">+</span>X)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  a.hat <span class="ot">&lt;-</span> <span class="fu">summary</span>(model.m)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  b.hat <span class="ot">&lt;-</span> <span class="fu">summary</span>(model.y)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  sa <span class="ot">&lt;-</span> <span class="fu">summary</span>(model.m)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  sb <span class="ot">&lt;-</span> <span class="fu">summary</span>(model.y)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  T.stat <span class="ot">&lt;-</span> (a.hat<span class="sc">*</span>b.hat)<span class="sc">/</span><span class="fu">sqrt</span>(a.hat<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sb<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>b.hat<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sa<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(T.stat)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The following statement may be a little confused in English, thus we
translate it in Chinese.</p>
<p>We would perform the permutation test in 3 different cases. First,
Note that our purpose is to control the type I error rate (t1e), hence
the test whose real parameter is 0 is what we concern. Since we have 3
variables <span class="math inline">\((X,M,Y)\)</span>, we choose to
permute different variable in different cases, and we only permute one
variable in each case. In this problem, we are concerned about the
variable pairs <span class="math inline">\((X,M)\)</span> and <span class="math inline">\((M,Y)\)</span>, thus the rules of permutation is
as follows:</p>
<ul>
<li><p><span class="math inline">\(\alpha=0,\beta=0\)</span>. Now we are
concerned about both the two variable pairs <span class="math inline">\((X,M)\)</span> and <span class="math inline">\((M,Y)\)</span>, thus we permute <span class="math inline">\(M\)</span>, so that we permute both the two
variable pairs.</p></li>
<li><p><span class="math inline">\(\alpha=0,\beta=1\)</span>. Now we are
only concerned about the variable pair <span class="math inline">\((X,M)\)</span>, thus we permute <span class="math inline">\(X\)</span>, so that we keep <span class="math inline">\((M,Y)\)</span> unchanged.</p></li>
<li><p><span class="math inline">\(\alpha=1,\beta=0\)</span>. Now we are
only concerned about the variable pair <span class="math inline">\((M,Y)\)</span>, thus we permute <span class="math inline">\(Y\)</span>, so that we keep <span class="math inline">\((X,M)\)</span> unchanged.</p></li>
</ul>
<p>In the simulation, in order to obtain the type I error rate, we need
to repeat the procedure for <span class="math inline">\(N\)</span>
times, each time we obtain a p-value of permutation test, then we
compute the ratio that <span class="math inline">\(p&lt;0.05\)</span>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>type1.err.rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># size of samples</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="co"># times of simulations</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># times of permutation</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 1: alpha=0, beta=0</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>p.perm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>stat.perm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(b)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="at">rate =</span> <span class="fl">0.3</span>)</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> alpha<span class="sc">*</span>X<span class="sc">+</span>em</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> beta<span class="sc">*</span>M<span class="sc">+</span>X<span class="sc">+</span>ey</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>stat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">T.stat</span>(X,M,Y)</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>b){</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>    M.perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(M)</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>    stat.perm[j] <span class="ot">&lt;-</span> <span class="fu">T.stat</span>(X,M.perm,Y)</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>  p.perm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stat.perm)<span class="sc">&gt;</span><span class="fu">abs</span>(stat[<span class="dv">1</span>]))</span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>type1.err.rate[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(p.perm<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 2: alpha=0, beta=1</span></span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a>p.perm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a>stat.perm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(b)</span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="at">rate =</span> <span class="fl">0.3</span>)</span>
<span id="cb85-42"><a href="#cb85-42" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb85-43"><a href="#cb85-43" aria-hidden="true" tabindex="-1"></a>ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb85-44"><a href="#cb85-44" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> alpha<span class="sc">*</span>X<span class="sc">+</span>em</span>
<span id="cb85-45"><a href="#cb85-45" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> beta<span class="sc">*</span>M<span class="sc">+</span>X<span class="sc">+</span>ey</span>
<span id="cb85-46"><a href="#cb85-46" aria-hidden="true" tabindex="-1"></a>stat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">T.stat</span>(X,M,Y)</span>
<span id="cb85-47"><a href="#cb85-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-48"><a href="#cb85-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb85-49"><a href="#cb85-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>b){</span>
<span id="cb85-50"><a href="#cb85-50" aria-hidden="true" tabindex="-1"></a>    X.perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(X)</span>
<span id="cb85-51"><a href="#cb85-51" aria-hidden="true" tabindex="-1"></a>    stat.perm[j] <span class="ot">&lt;-</span> <span class="fu">T.stat</span>(X.perm,M,Y)</span>
<span id="cb85-52"><a href="#cb85-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-53"><a href="#cb85-53" aria-hidden="true" tabindex="-1"></a>  p.perm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stat.perm)<span class="sc">&gt;</span><span class="fu">abs</span>(stat[<span class="dv">2</span>]))</span>
<span id="cb85-54"><a href="#cb85-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-55"><a href="#cb85-55" aria-hidden="true" tabindex="-1"></a>type1.err.rate[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(p.perm<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb85-56"><a href="#cb85-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-57"><a href="#cb85-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 3: alpha=1, beta=0</span></span>
<span id="cb85-58"><a href="#cb85-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-59"><a href="#cb85-59" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb85-60"><a href="#cb85-60" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-61"><a href="#cb85-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-62"><a href="#cb85-62" aria-hidden="true" tabindex="-1"></a>p.perm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb85-63"><a href="#cb85-63" aria-hidden="true" tabindex="-1"></a>stat.perm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(b)</span>
<span id="cb85-64"><a href="#cb85-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-65"><a href="#cb85-65" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb85-66"><a href="#cb85-66" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="at">rate =</span> <span class="fl">0.3</span>)</span>
<span id="cb85-67"><a href="#cb85-67" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb85-68"><a href="#cb85-68" aria-hidden="true" tabindex="-1"></a>ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb85-69"><a href="#cb85-69" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> alpha<span class="sc">*</span>X<span class="sc">+</span>em</span>
<span id="cb85-70"><a href="#cb85-70" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> beta<span class="sc">*</span>M<span class="sc">+</span>X<span class="sc">+</span>ey</span>
<span id="cb85-71"><a href="#cb85-71" aria-hidden="true" tabindex="-1"></a>stat[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">T.stat</span>(X,M,Y)</span>
<span id="cb85-72"><a href="#cb85-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-73"><a href="#cb85-73" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb85-74"><a href="#cb85-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>b){</span>
<span id="cb85-75"><a href="#cb85-75" aria-hidden="true" tabindex="-1"></a>    Y.perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(Y)</span>
<span id="cb85-76"><a href="#cb85-76" aria-hidden="true" tabindex="-1"></a>    stat.perm[j] <span class="ot">&lt;-</span> <span class="fu">T.stat</span>(X,M,Y.perm)</span>
<span id="cb85-77"><a href="#cb85-77" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-78"><a href="#cb85-78" aria-hidden="true" tabindex="-1"></a>  p.perm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(stat.perm)<span class="sc">&gt;</span><span class="fu">abs</span>(stat[<span class="dv">3</span>]))</span>
<span id="cb85-79"><a href="#cb85-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-80"><a href="#cb85-80" aria-hidden="true" tabindex="-1"></a>type1.err.rate[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(p.perm<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb85-81"><a href="#cb85-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-82"><a href="#cb85-82" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="at">alpha=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">beta=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb85-83"><a href="#cb85-83" aria-hidden="true" tabindex="-1"></a>                          <span class="at">type1.err.rate=</span>type1.err.rate))</span></code></pre></div>
<table style="width:44%;">
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">alpha</th>
<th align="center">beta</th>
<th align="center">type1.err.rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>Though the result seems to be perfect (all the t1e is 0 under these
seeds), it is not always good, because sometimes one of the 3 type I
errors may be larger than 0.05. Anyway, our method seems reasonable and
the performance is satisfied enough.</p>
</div>
<div id="question-2-1" class="section level3">
<h3>Question 2</h3>
<p><strong>Solution.</strong> The function is similar to the Example 1
in the slides of chapter 7.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) write down the R function</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>myfun <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) set the parameters and apply the function</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e-1</span>,<span class="fl">1e-2</span>,<span class="fl">1e-3</span>,<span class="fl">1e-4</span>)</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(f0))</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f0)){</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>  alpha[i] <span class="ot">&lt;-</span> <span class="fu">myfun</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) report the result</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="at">f0=</span>f0,<span class="at">alpha=</span>alpha))</span></code></pre></div>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">f0</th>
<th align="center">alpha</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.1</td>
<td align="center">-3.17</td>
</tr>
<tr class="even">
<td align="center">0.01</td>
<td align="center">-6.07</td>
</tr>
<tr class="odd">
<td align="center">0.001</td>
<td align="center">-8.72</td>
</tr>
<tr class="even">
<td align="center">1e-04</td>
<td align="center">-11.3</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(alpha,f0,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pch=</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Class work</p></li>
<li><p>2.1.3 Exercise 4, 5 (Pages 19 Advanced in R)</p></li>
<li><p>2.3.1 Exercise 1, 2 (Pages 26 Advanced in R)</p></li>
<li><p>2.4.5 Exercise 1, 2, 3 (Pages 30 Advanced in R) <a href="#question4ans">Jump to the Answer</a></p></li>
</ol>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="class-work" class="section level3">
<h3>Class work</h3>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li>The complete likelihood function is <span class="math inline">\(L_c(\lambda)=\lambda^ne^{-\lambda\sum_{i=1}^nx_i}\)</span>,
and the complete log-likelihood is <span class="math inline">\(l_c(\lambda)=n\ln(\lambda)-\lambda\sum_{i=1}^n
x_i\)</span>.</li>
</ol>
<p>The observed likelihood function is <span class="math inline">\(L_o(\lambda)=\prod_{i=1}^nP(u_i\le x_i\le
v_i)=\prod_{i=1}^n(e^{-\lambda u_i}-e^{-\lambda v_i})\)</span>, and the
observed log-likelihood is <span class="math inline">\(l_o(\lambda)=\sum_{i=1}^n\ln(e^{-\lambda
u_i}-e^{-\lambda v_i})\)</span></p>
<p>E-step: <span class="math display">\[
\begin{aligned}
E_{\lambda_0}[l_c(\lambda)|(u_i,v_i),i=1,\dots,n]&amp;=n\ln\lambda-\lambda\sum_{i=1}^nE_{\lambda_0}[x_i|(u_i,v_i)]\\
&amp;=n\ln\lambda-\lambda\sum_{i=1}^n\left(\frac{u_ie^{-\lambda_0u_i}-v_ie^{-\lambda_0v_i}}{e^{-\lambda_0u_i}-e^{-\lambda_0v_i}}+\frac{1}{\lambda_0}\right).
\end{aligned}
\]</span></p>
<p>M-step: we maximize the objective function obtained by E-step, and
yields the iteration equation <span class="math display">\[
\lambda_1=n\left(\sum_{i=1}^n\frac{u_ie^{-\lambda_0u_i}-v_ie^{-\lambda_0v_i}}{e^{-\lambda_0u_i}-e^{-\lambda_0v_i}}+\frac{n}{\lambda_0}\right)^{-1}.
\]</span></p>
<p>The MLE estimator <span class="math inline">\(\hat\lambda\)</span>
satisfies the likelihood function <span class="math display">\[
\sum_{i=1}^n\frac{-u_ie^{-\lambda_0u_i}+v_ie^{-\lambda_0v_i}}{e^{-\lambda_0u_i}-e^{-\lambda_0v_i}}=0.
\]</span> It is obvious that <span class="math inline">\(\hat\lambda\)</span> is the fixed point of the
iteration equation of EM algorithm.</p>
<p>Now we prove that the EM algorithm is indeed convergent. We rewrite
the iteration equation as a function of <span class="math inline">\(\lambda\)</span>, that is <span class="math display">\[
f(\lambda)=n\left(\sum_{i=1}^n\frac{u_ie^{-\lambda u_i}-v_ie^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}+\frac{n}{\lambda}\right)^{-1}.
\]</span> Then we take the derivative of <span class="math inline">\(f\)</span> and yields <span class="math display">\[
\begin{aligned}
f&#39;(\lambda)=-n\left(\sum_{i=1}^n\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}+\frac{n}{\lambda}\right)^{-2}\left[-\frac{n}{\lambda^2}+\\
\sum_{i=1}^n\left(\frac{-u_i^2e^{-\lambda u_i}+v_i^2e^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}+\bigg(\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}\bigg)^2\right)\right].
\end{aligned}
\]</span> When <span class="math inline">\(\lambda\)</span> is closed to
the fixed point <span class="math inline">\(\hat\lambda\)</span>, we
have <span class="math display">\[
f&#39;(\lambda)\approx
-\frac{\lambda^2}{n}\left[-\frac{n}{\lambda^2}+\cdots\right]=:1-A.
\]</span> In order to apply the contraction mapping theorem, we require
that <span class="math inline">\(|f&#39;(\lambda)|&lt;1\)</span>, that
is <span class="math inline">\(0&lt;A&lt;2\)</span>, which would be
attained if the sample size <span class="math inline">\(n\)</span> is
much larger than <span class="math inline">\(\lambda\)</span>. However,
it is suspect whether the convergent property holds generally, even if
<span class="math inline">\(\lambda\)</span> is closed to the fixed
point.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>EM <span class="ot">&lt;-</span> <span class="cf">function</span>(u,v,init,<span class="at">max.iter=</span><span class="fl">1e4</span>){</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  lambda0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  lambda1 <span class="ot">&lt;-</span> init</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(lambda1<span class="sc">-</span>lambda0)<span class="sc">&gt;</span><span class="fl">1e-5</span>){</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>    lambda0 <span class="ot">&lt;-</span> lambda1</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>    lambda1 <span class="ot">&lt;-</span> n<span class="sc">*</span>(<span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda1<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda1<span class="sc">*</span>v))<span class="sc">/</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>                        (<span class="fu">exp</span>(<span class="sc">-</span>lambda1<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda1<span class="sc">*</span>v)))<span class="sc">+</span>n<span class="sc">/</span>lambda1)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(k<span class="sc">&gt;</span>max.iter) <span class="cf">break</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">lambda=</span><span class="fu">round</span>(lambda1,<span class="dv">4</span>),<span class="at">iter=</span>k))</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(u,v){</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>((<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">+</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>  mle <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))<span class="sc">$</span>root</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mle)</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">EM</span>(u,v,<span class="at">init =</span> <span class="dv">1</span>))</span></code></pre></div>
<table style="width:25%;">
<colgroup>
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">lambda</th>
<th align="center">iter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.072</td>
<td align="center">3</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">MLE</span>(u,v),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.072</code></pre>
<p>We obtain the same result by the two different methods.</p>
</div>
<div id="exercise-4-5" class="section level3">
<h3>2.1.3 Exercise 4, 5</h3>
<ol start="4" style="list-style-type: decimal">
<li>Why do you need to use <code>unlist()</code> to convert a list to an
atomic vector? Why doesn’t <code>as.vector()</code> work?</li>
</ol>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.list</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.vector</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(a)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>We can see that the item <code>a</code> is both a list and a vector,
thus it make no sense to use function <code>as.vector</code>, and we
need to use <code>unlist</code> to convert <code>a</code> to an atomic
vector.</p>
<ol start="5" style="list-style-type: decimal">
<li>Why is <code>1 == &quot;1&quot;</code> true? Why is <code>-1 &lt; FALSE</code>
true? Why is <code>&quot;one&quot; &lt; 2</code> false?</li>
</ol>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.character</span>(<span class="st">&quot;1&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.logical</span>(<span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>If the two arguments are atomic vectors of different types, one is
coerced to the type of the other, the (decreasing) order of precedence
being character, complex, numeric, integer, logical and raw. Hence, for
<code>1==&quot;1&quot;</code> the numeric value <code>1</code> is coerced to
character, and for <code>-1 &lt; FALSE</code> the logical value
<code>FALSE</code> is coerced to numeric value.</p>
</div>
<div id="exercise-1-2" class="section level3">
<h3>2.3.1 Exercise 1, 2</h3>
<ol style="list-style-type: decimal">
<li>What does <code>dim()</code> return when applied to a vector?</li>
</ol>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(b)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>We can see that the return value is <code>NULL</code>.</p>
<ol start="2" style="list-style-type: decimal">
<li>If <code>is.matrix(x)</code> is TRUE, what will
<code>is.array(x)</code> return?</li>
</ol>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>We can see that if <code>is.matrix(x)</code> is <code>TRUE</code>,
then <code>is.array(x)</code> is also <code>TRUE</code>.</p>
</div>
<div id="question4ans" class="section level3">
<h3>2.4.5 Exercise 1, 2, 3</h3>
<ol style="list-style-type: decimal">
<li>What attributes does a data frame possess?</li>
</ol>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(df)</span></code></pre></div>
<pre><code>## $names
## [1] &quot;x&quot; &quot;y&quot;
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $row.names
## [1] 1 2 3</code></pre>
<p>We can see that a data frame has 3 attributes, that is
<code>name</code>, <code>class</code> and <code>row.name</code>.</p>
<ol start="2" style="list-style-type: decimal">
<li>What does <code>as.matrix()</code> do when applied to a data frame
with columns of different types?</li>
</ol>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(df<span class="sc">$</span>x)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(df<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(df)</span></code></pre></div>
<pre><code>##      x   y  
## [1,] &quot;1&quot; &quot;a&quot;
## [2,] &quot;2&quot; &quot;b&quot;
## [3,] &quot;3&quot; &quot;c&quot;</code></pre>
<p>The function <code>as.matrix</code> coerce the type of lower order
(integer) to the type of higher order (character).</p>
<ol start="3" style="list-style-type: decimal">
<li>Can you have a data frame with 0 rows? What about 0 columns?</li>
</ol>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df[<span class="cn">FALSE</span>,]</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>df1</span></code></pre></div>
<pre><code>## [1] x y
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df[,<span class="cn">FALSE</span>]</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>df2</span></code></pre></div>
<pre><code>## data frame with 0 columns and 3 rows</code></pre>
<p>As is shown above, we can have a data frame with 0 rows or 0
columns.</p>
</div>
</div>
</div>
<div id="hw10" class="section level1">
<h1>HW10</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 2 (page 204, Advanced R)</p></li>
<li><p>Exercises 1 (page 213, Advanced R)</p></li>
<li><p>Gibbs sampler in <code>Rcpp</code>.</p></li>
</ol>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="exercises-2-page-204-advanced-r" class="section level3">
<h3>Exercises 2 (page 204, Advanced R)</h3>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Solution.</strong></p>
<p>If a data frame consists of numeric columns, then we can apply the
function <code>scale01</code> to every column of the data frame directly
by <code>lapply</code> as follows.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">b=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(df1,scale01)</span></code></pre></div>
<pre><code>## $a
## [1] 0.0 0.5 1.0
## 
## $b
## [1] 0.0 0.5 1.0</code></pre>
<p>However, if the data frame has non-numeric column, the code would
fail because the function <code>scale01</code> is only suitable for
numeric vectors.</p>
<p>If we want to apply <code>scale01</code> to a data frame which
possesses non-numeric columns, we need to select the numeric column
first.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(df1,is.numeric))</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(df1[,id<span class="sc">==</span><span class="cn">TRUE</span>],scale01)</span></code></pre></div>
<pre><code>## $a
## [1] 0.0 0.5 1.0
## 
## $b
## [1] 0.0 0.5 1.0</code></pre>
<p>Here we omit the column “c” since it is not numeric.</p>
</div>
<div id="exercises-1-page-213-advanced-r" class="section level3">
<h3>Exercises 1 (page 213, Advanced R)</h3>
<p>Use <code>vapply()</code> to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use <code>vapply()</code>
twice.)</p></li>
</ol>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: lower-alpha">
<li>We generate a data frame <code>df2</code> randomly and use
<code>vapply()</code> to compute the standard deviation.</li>
</ol>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">5</span>),<span class="at">b=</span><span class="fu">runif</span>(<span class="dv">5</span>))</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df2,<span class="at">FUN =</span> sd,<span class="at">FUN.VALUE =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##         a         b 
## 0.7305264 0.2437402</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>We add a character column to <code>df2</code> and compute standard
deviation of every numeric column.</li>
</ol>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>c <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">vapply</span>(df2,is.numeric,<span class="at">FUN.VALUE =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df2[,id<span class="sc">==</span><span class="cn">TRUE</span>],<span class="at">FUN =</span> sd,<span class="at">FUN.VALUE =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##         a         b 
## 0.7305264 0.2437402</code></pre>
</div>
<div id="gibbs-sampler-in-rcpp" class="section level3">
<h3>Gibbs sampler in <code>Rcpp</code></h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation 0.9.</p>
<ul>
<li><p>Write an Rcpp function.</p></li>
<li><p>Compare the corresponding generated random numbers with pure R
language using the function “qqplot”.</p></li>
<li><p>Compare the computation time of the two functions with the
function “microbenchmark”.</p></li>
</ul>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, burn, mu, sigma, rho){</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  mu1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>]</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  mu2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>]</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  sigma1 <span class="ot">&lt;-</span> sigma[<span class="dv">1</span>]</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="ot">&lt;-</span> sigma[<span class="dv">2</span>]</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">###### generate the chain #####</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">X=</span>X))</span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-26"><a href="#cb134-26" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb134-27"><a href="#cb134-27" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co">#length of chain</span></span>
<span id="cb134-28"><a href="#cb134-28" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#burn-in length</span></span>
<span id="cb134-29"><a href="#cb134-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-30"><a href="#cb134-30" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb134-31"><a href="#cb134-31" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb134-32"><a href="#cb134-32" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1,mu2)</span>
<span id="cb134-33"><a href="#cb134-33" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb134-34"><a href="#cb134-34" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma1,sigma2)</span></code></pre></div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp22099)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co">#sourceCpp(&#39;gibbsC.cpp&#39;)</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>gibbR <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(N,burn,mu,sigma,rho)<span class="sc">$</span>x</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>gibbC <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(N,burn,rho)[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gibbR[,<span class="dv">1</span>],gibbR[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gibbC[,<span class="dv">1</span>],gibbC[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6ZrY6kNtmAABmkJBmtv+QOgCQkGaQ2/+2ZgC2Zjq2tma2///bkDrb////tmb/trb/25D//7b//9v///9cnWTQAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALFUlEQVR4nO2dDXvbqBKFaZvsbnKTrXfrepPw///ntT6A4UsHELKU+Jznaeo4CI3eDDMMIrLS1KLU3gYcXQQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQECdAalPo70A9e2ui5I0CMhK6ZRZBGSkxNfo7eLju4mAbtvdes0BiIAyUgMixqCsJu9hFsvIkEkZRUB2eBFQRvPwCm3KRe3FbvrpUIAGFmEAUuJfYTedrTqMRjJhfLZB6e4A+Z4y+Y4mIO+8yv9uHmJxu3sE5KdzlXhPttwwBp2vv5SX8cX3Xx2666YkoMwUesssdv72U78/P+gjARIcPECJDOYdVtx/hS0fr0/j1x+/jwNoHi5T1DFAFqeI7rjiE5Tq/XkcXvr043cAqH4ls5PsaJrP7f4TP84fWHyGMk0edNXpYScPin4DjsOExv6SdgFkB9b7s9oFUJR+lJvsGDxydC1Ys1kWmwbZx+segCKvUC4Wq5mI47I83isBXV1CKnP1xd1tpBDQnK3G6aDSvvOU9VXc0ITfSZfPAMgE5tl93AiLyouFvoobfg5AMq7YiOwlL/FWQVfF5+yoW2UxEZJN5pIJHptRDQgWEXXddVXCJZR1Fj+74/xuOig++fQfLiKquuuqlEtYNu4/61FFdlQCKigiarrrqkxV7qhox0irjQDli4hKbQzIDTa5T0PZVO/PhLoYKj1ILxURNd11lQUkM5VWKR+S7XoZamIQLCKquusqc93GO2Tw8UaYgdTVUJfFQBHR+bxVnZpcJUeWDjiV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" /><!-- --></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibbR[,<span class="dv">1</span>],gibbC[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibbR[,<span class="dv">2</span>],gibbC[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbR=</span><span class="fu">gibbsR</span>(N,burn,mu,sigma,rho)<span class="sc">$</span>x,</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="at">gibbC=</span><span class="fu">gibbsC</span>(N,burn,rho))</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##    expr      lq  median      uq
## 1 gibbR 1133.45 1162.20 1220.20
## 2 gibbC   86.65   89.35   96.95</code></pre>
<p>From the result above, we can see that the computation time of the
<code>cpp</code> program is much less than the <code>R</code> program.
The scatter plots and qqplots show that the samples of two functions fit
perfectly.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
